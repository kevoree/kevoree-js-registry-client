!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("TinyConf"),require("btoa"),require("fetch")):"function"==typeof define&&define.amd?define(["TinyConf","btoa","fetch"],t):"object"==typeof exports?exports.KevoreeRegistryClient=t(require("TinyConf"),require("btoa"),require("fetch")):e.KevoreeRegistryClient=t(e.TinyConf,e.btoa,e.fetch)}(this,function(e,t,r){return function(e){function t(n){if(r[n])return r[n].exports;var s=r[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=7)}([/*!****************************!*\
  !*** ./src/util/config.js ***!
  \****************************/
function(e,t,r){"use strict";function n(){var e=i.get("user");if(!s())return e.access_token;throw new Error("Current user is not authenticated with "+i.baseUrl())}function s(){var e=i.get("user");return!e||!e.access_token||!e.expires_at||e.expires_at<=Date.now()}function o(){var e=i.get("registry");return(e.ssl?"https":"http")+"://"+e.host+":"+e.port}function a(){var e=i.get("registry.oauth.client_id"),t=i.get("registry.oauth.client_secret");return u(e+":"+t)}var i=r(/*! tiny-conf */8),u=r(/*! ./btoa */9);e.exports=i,e.exports.token=n,e.exports.baseUrl=o,e.exports.clientAuthorization=a,e.exports.isTokenExpired=s},/*!***********************************!*\
  !*** ./src/util/fetch-wrapper.js ***!
  \***********************************/
function(e,t,r){"use strict";function n(e){if(e.status>=200&&e.status<300)return e;var t=e.headers.get("Content-Type");if(t&&-1!==t.indexOf("application/json"))return e.json().then(function(t){var r="";t.message?r=" - "+t.message:t.error_description&&(r=" - "+t.error_description);var n=new Error(e.status+" - "+e.statusText+r);throw n.response=e,n});var r=new Error(e.status+" - "+e.statusText+" - "+e.url);throw r.response=e,r}function s(e){var t=e.headers.get("Content-Type");return t&&-1!==t.indexOf("application/json")?e.json():e}var o=r(/*! node-fetch */10);e.exports=function(e,t){return o(e,Object.assign({headers:{Accept:"application/json"}},t)).then(n).then(s)}},/*!*******************************!*\
  !*** ./src/util/qs-encode.js ***!
  \*******************************/
function(e,t,r){"use strict";function n(e){return Object.keys(e).reduce(function(t,r,n){return t+(n>0?"&":"")+r+"="+e[r]},"")}e.exports=n},/*!*********************!*\
  !*** ./src/auth.js ***!
  \*********************/
function(e,t,r){"use strict";function n(e){return function(){return e.client_id=a.get("registry.oauth.client_id"),e.client_secret=a.get("registry.oauth.client_secret"),o(a.baseUrl()+"/oauth/token",{method:"POST",body:i(e),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",Authorization:"Basic "+a.clientAuthorization()}}).then(function(e){a.set("user.access_token",e.access_token),a.set("user.refresh_token",e.refresh_token);var t=new Date;t.setSeconds(t.getSeconds()+e.expires_in),a.set("user.expires_at",t.getTime())})}}function s(){var e=a.get("user");return n({username:e.login,password:e.password,grant_type:"password",scope:"read%20write"})}var o=r(/*! ./util/fetch-wrapper */1),a=r(/*! ./util/config */0),i=r(/*! ./util/qs-encode */2);e.exports={login:function(){var e=this;return new Promise(function(e,t){try{a.token(),e()}catch(e){t(e)}}).catch(function(){return a.isTokenExpired()?e.refresh().catch(s()):s()()})},logout:function(){throw new Error("api.auth.logout() is not implemented yet")},refresh:function(){var e=a.get("user.refresh_token");return e?n({grant_type:"refresh_token",refresh_token:e,scope:"read%20write"})():Promise.reject(new Error("Invalid refresh_token: "+e))}}},/*!*******************!*\
  !*** ./src/du.js ***!
  \*******************/
function(e,t,r){"use strict";var n=r(/*! ./util/fetch-wrapper */1),s=r(/*! ./util/config */0),o=r(/*! ./util/qs-encode */2);e.exports={all:function(){return n(s.baseUrl()+"/api/dus")},get:function(e){return n(s.baseUrl()+"/api/dus/"+e)},getAllByNamespaceAndTdefName:function(e,t){return n(s.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/dus")},getAllByNamespaceAndTdefNameAndTdefVersion:function(e,t,r){return n(s.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+r+"/dus")},getSpecificByNamespaceAndTdefNameAndTdefVersion:function(e,t,r,a){return n(s.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+r+"/specific-dus?"+o(a))},create:function(e,t,r,o){return n(s.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+r+"/dus",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+s.token()},body:JSON.stringify(o)})},delete:function(e){return n(s.baseUrl()+"/api/dus/"+e,{method:"DELETE",headers:{Authorization:"Bearer "+s.token()}})},deleteByNamespaceAndTdefNameAndTdefVersionAndNameAndVersionAndPlatform:function(e,t,r,o,a,i){return n(s.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+r+"/dus/"+o+"/"+a+"/"+i,{method:"DELETE",headers:{Authorization:"Bearer "+s.token()}})}}},/*!**************************!*\
  !*** ./src/namespace.js ***!
  \**************************/
function(e,t,r){"use strict";var n=r(/*! ./util/fetch-wrapper */1),s=r(/*! ./util/config */0);e.exports={all:function(){return n(s.baseUrl()+"/api/namespaces")},get:function(e){return n(s.baseUrl()+"/api/namespaces/"+e)},create:function(e){return n(s.baseUrl()+"/api/namespaces",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+s.token()},body:JSON.stringify({name:e})})},delete:function(e){return n(s.baseUrl()+"/api/namespaces/"+e,{method:"DELETE",headers:{Authorization:"Bearer "+s.token()}})},addMember:function(e,t){return n(s.baseUrl()+"/api/namespaces/"+e+"/members",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+s.token()},body:JSON.stringify({name:t})})},removeMember:function(e,t){return n(s.baseUrl()+"/api/namespaces/"+e+"/members/"+t,{method:"DELETE",headers:{Authorization:"Bearer "+s.token()}})}}},/*!*********************!*\
  !*** ./src/tdef.js ***!
  \*********************/
function(e,t,r){"use strict";var n=r(/*! ./util/fetch-wrapper */1),s=r(/*! ./util/config */0);e.exports={all:function(){return n(s.baseUrl()+"/api/tdefs")},get:function(e){return n(s.baseUrl()+"/api/tdefs/"+e)},getAllByNamespaceAndName:function(e,t){return n(s.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t)},getLatestByNamespaceAndName:function(e,t){return n(s.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/latest")},getByNamespaceAndNameAndVersion:function(e,t,r){return n(s.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+r)},create:function(e,t){return n(s.baseUrl()+"/api/namespaces/"+e+"/tdefs",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+s.token()},body:JSON.stringify(t)})},delete:function(e){return n(s.baseUrl()+"/api/tdefs/"+e,{method:"DELETE",headers:{Authorization:"Bearer "+s.token()}})},deleteByNamespaceAndNameAndVersion:function(e,t,r){return n(s.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+r,{method:"DELETE",headers:{Authorization:"Bearer "+s.token()}})}}},/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
function(e,t,r){"use strict";e.exports={auth:r(/*! ./auth */3),namespace:r(/*! ./namespace */5),tdef:r(/*! ./tdef */6),du:r(/*! ./du */4)}},/*!***************************!*\
  !*** external "TinyConf" ***!
  \***************************/
function(t,r){t.exports=e},/*!***********************!*\
  !*** external "btoa" ***!
  \***********************/
function(e,r){e.exports=t},/*!************************!*\
  !*** external "fetch" ***!
  \************************/
function(e,t){e.exports=r}])});