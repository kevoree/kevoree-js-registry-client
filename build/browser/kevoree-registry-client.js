!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("TinyConf"),require("btoa"),require("fetch")):"function"==typeof define&&define.amd?define(["TinyConf","btoa","fetch"],t):"object"==typeof exports?exports.KevoreeRegistryClient=t(require("TinyConf"),require("btoa"),require("fetch")):e.KevoreeRegistryClient=t(e.TinyConf,e.btoa,e.fetch)}(this,function(e,t,n){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/build/browser/",t(t.s=8)}([/*!***********************************!*\
  !*** ./build/main/util/config.js ***!
  \***********************************/
function(e,t,n){"use strict";function r(){var e=i.get("user.access_token");if(e)return e;throw new Error("Unable to find a valid token")}function a(){var e=i.get("user");return!e||!e.access_token||!e.expires_at||e.expires_at<=Date.now()}function o(){var e=i.get("registry");return(e.ssl?"https":"http")+"://"+e.host+":"+e.port}function s(){var e=i.get("registry.oauth.client_id"),t=i.get("registry.oauth.client_secret");return u(e+":"+t)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(/*! tiny-conf */10),u=n(/*! ./btoa */11);t.token=r,t.isTokenExpired=a,t.baseUrl=o,t.clientAuthorization=s,t.default=i},/*!******************************************!*\
  !*** ./build/main/util/fetch-wrapper.js ***!
  \******************************************/
function(e,t,n){"use strict";function r(e){if(e.status>=200&&e.status<300)return e;var t=e.headers.get("Content-Type");if(t&&-1!==t.indexOf("application/json"))return e.json().then(function(t){throw t.message?new i.default(e," - "+t.message):t.error_description?new i.default(e," - "+t.error_description):new i.default(e)});throw new i.default(e," - "+e.url)}function a(e){var t=e.headers.get("Content-Type");return t&&-1!==t.indexOf("application/json")?e.json():e}function o(e,t){return s(e,Object.assign({headers:{Accept:"application/json"}},t)).then(r).then(a)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(/*! node-fetch */12),i=n(/*! ./client-error */9);t.default=o},/*!**************************************!*\
  !*** ./build/main/util/qs-encode.js ***!
  \**************************************/
function(e,t,n){"use strict";function r(e){return Object.keys(e).reduce(function(t,n,r){return t+(r>0?"&":"")+n+"="+e[n]},"")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},/*!*******************************!*\
  !*** ./build/main/account.js ***!
  \*******************************/
function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(/*! ./util/fetch-wrapper */1),a=n(/*! ./util/config */0);t.default={get:function(){return r.default(a.baseUrl()+"/api/account",{headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.token()}})}}},/*!****************************!*\
  !*** ./build/main/auth.js ***!
  \****************************/
function(e,t,n){"use strict";function r(e){return function(){return o.default(s.baseUrl()+"/oauth/token",{method:"POST",body:i.default(Object.assign({client_id:s.default.get("registry.oauth.client_id"),client_secret:s.default.get("registry.oauth.client_secret")},e)),headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json",Authorization:"Basic "+s.clientAuthorization()}}).then(function(e){var t=s.default.get("user"),n=new Date;n.setSeconds(n.getSeconds()+e.expires_in),t.access_token=e.access_token,t.refresh_token=e.refresh_token,t.expires_at=n.getTime()})}}function a(){var e=s.default.get("user");return e?r({username:e.login,password:e.password,grant_type:"password",scope:"read%20write"}):function(){return Promise.reject(new Error('Unable to find "user" in local config'))}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(/*! ./util/fetch-wrapper */1),s=n(/*! ./util/config */0),i=n(/*! ./util/qs-encode */2);t.default={login:function(){var e=this;return Promise.resolve().then(function(){return s.token(),s.isTokenExpired()?e.refresh().catch(a()):void 0}).catch(a())},logout:function(){throw new Error("api.auth.logout() is not implemented yet")},refresh:function(){var e=s.default.get("user");return e?e.refresh_token?r({grant_type:"refresh_token",refresh_token:e.refresh_token,scope:"read%20write"})():Promise.reject(new Error("Invalid refresh_token: "+e.refresh_token)):Promise.reject(new Error('Unable to find "user" in local config'))},getToken:function(){return s.token()},isTokenExpired:function(){return s.isTokenExpired()}}},/*!**************************!*\
  !*** ./build/main/du.js ***!
  \**************************/
function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(/*! ./util/fetch-wrapper */1),a=n(/*! ./util/config */0),o=n(/*! ./util/qs-encode */2);t.default={all:function(){return r.default(a.baseUrl()+"/api/dus")},get:function(e){return r.default(a.baseUrl()+"/api/dus/"+e)},getAllByNamespaceAndTdefName:function(e,t){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/dus")},getAllByNamespaceAndTdefNameAndTdefVersion:function(e,t,n){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n+"/dus")},getByNamespaceAndTdefNameAndTdefVersionAndNameAndVersionAndPlatform:function(e,t,n,o,s,i){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n+"/dus/"+o+"/"+s+"/"+i)},getSpecificByNamespaceAndTdefNameAndTdefVersion:function(e,t,n,s){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n+"/specific-dus?"+o.default(s))},getLatests:function(e,t,n){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n+"/dus?version=latest")},getReleases:function(e,t,n){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n+"/dus?version=release")},getLatestByPlatform:function(e,t,n,o){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n+"/dus?version=latest&platform="+o).then(function(e){return e[0]})},getReleaseByPlatform:function(e,t,n,o){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n+"/dus?version=release&platform="+o).then(function(e){return e[0]})},create:function(e,t,n,o){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n+"/dus",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.token()},body:JSON.stringify(o)})},update:function(e){return r.default(a.baseUrl()+"/api/namespaces/"+e.namespace+"/tdefs/"+e.tdefName+"/"+e.tdefVersion+"/dus/"+e.name+"/"+e.version+"/"+e.platform,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.token()},body:JSON.stringify(e)})},delete:function(e){return r.default(a.baseUrl()+"/api/dus/"+e,{method:"DELETE",headers:{Authorization:"Bearer "+a.token()}})},deleteByNamespaceAndTdefNameAndTdefVersionAndNameAndVersionAndPlatform:function(e,t,n,o,s,i){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n+"/dus/"+o+"/"+s+"/"+i,{method:"DELETE",headers:{Authorization:"Bearer "+a.token()}})}}},/*!*********************************!*\
  !*** ./build/main/namespace.js ***!
  \*********************************/
function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(/*! ./util/fetch-wrapper */1),a=n(/*! ./util/config */0);t.default={all:function(){return r.default(a.baseUrl()+"/api/namespaces")},get:function(e){return r.default(a.baseUrl()+"/api/namespaces/"+e)},create:function(e){return r.default(a.baseUrl()+"/api/namespaces",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.token()},body:JSON.stringify({name:e})})},delete:function(e){return r.default(a.baseUrl()+"/api/namespaces/"+e,{method:"DELETE",headers:{Authorization:"Bearer "+a.token()}})},addMember:function(e,t){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/members",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.token()},body:JSON.stringify({name:t})})},removeMember:function(e,t){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/members/"+t,{method:"DELETE",headers:{Authorization:"Bearer "+a.token()}})}}},/*!****************************!*\
  !*** ./build/main/tdef.js ***!
  \****************************/
function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(/*! ./util/fetch-wrapper */1),a=n(/*! ./util/config */0);t.default={all:function(){return r.default(a.baseUrl()+"/api/tdefs")},get:function(e){return r.default(a.baseUrl()+"/api/tdefs/"+e)},getAllByNamespace:function(e){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs")},getLatestsByNamespace:function(e){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs?version=latest")},getAllByNamespaceAndName:function(e,t){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t)},getLatestByNamespaceAndName:function(e,t){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/latest")},getByNamespaceAndNameAndVersion:function(e,t,n){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n)},create:function(e,t){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.token()},body:JSON.stringify(t)})},delete:function(e){return r.default(a.baseUrl()+"/api/tdefs/"+e,{method:"DELETE",headers:{Authorization:"Bearer "+a.token()}})},deleteByNamespaceAndNameAndVersion:function(e,t,n){return r.default(a.baseUrl()+"/api/namespaces/"+e+"/tdefs/"+t+"/"+n,{method:"DELETE",headers:{Authorization:"Bearer "+a.token()}})}}},/*!*****************************!*\
  !*** ./build/main/index.js ***!
  \*****************************/
function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(/*! ./account */3);t.account=r.default;var a=n(/*! ./auth */4);t.auth=a.default;var o=n(/*! ./namespace */6);t.namespace=o.default;var s=n(/*! ./tdef */7);t.tdef=s.default;var i=n(/*! ./du */5);t.du=i.default},/*!*****************************************!*\
  !*** ./build/main/util/client-error.js ***!
  \*****************************************/
function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(e,n){r(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.status+" - "+e.statusText+(n||"")));return Object.setPrototypeOf(o,t.prototype),o.name="KevoreeRegistryClientError",o.statusCode=e.status,o.statusText=e.statusText,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(o,o.constructor):o.stack=(new Error).stack,o}return o(t,e),t}(Error);t.default=s},/*!***************************!*\
  !*** external "TinyConf" ***!
  \***************************/
function(t,n){t.exports=e},/*!***********************!*\
  !*** external "btoa" ***!
  \***********************/
function(e,n){e.exports=t},/*!************************!*\
  !*** external "fetch" ***!
  \************************/
function(e,t){e.exports=n}])});